<header class="page-header">
  <p>Browse {{ sectionName }}</p>
  <div class="button-add button" (click)="togglePopup(false, -1)">
    {{ isPopupVisible && !isPopupEdit ? "Close" : "Add Document" }}
  </div>
</header>
<main class="page-main">
  <div class="settings">
    <p>
      Showing {{ documents.length }}
      {{ documents.length == 1 ? "entry" : "entries" }}
    </p>
    <div class="search-setting">
      <form
        class="search-form"
        [formGroup]="searchFieldForm"
        (submit)="
          changePage(1, searchFieldForm.value.search == '' ? false : true)
        "
      >
        <select
          name="search-param"
          class="search-form-select"
          formControlName="select"
        >
          <option value="" class="search-form-option">
            --- Choose Filter ---
          </option>
          <option
            *ngFor="let property of docProperty"
            value="{{ property[0] }}"
          >
            {{ property[1].name }}
          </option>
        </select>
        <input
          type="text"
          class="search-form-input"
          placeholder="Enter value..."
          formControlName="search"
        />
        <button type="submit" class="button search-form-button">Search</button>
      </form>
    </div>
  </div>
  <table class="documents-table">
    <thead>
      <th *ngFor="let property of docProperty" class="{{ property[1].class }}">
        {{ property[1].name }}
      </th>
      <th class="action-th">Action</th>
    </thead>
    <tbody class="documents-table-body">
      <!-- Wait for pagination service to fetch documents -->
      <tr *ngFor="let document of documents; let i = index">
        <td *ngFor="let property of docProperty">
          {{
            property[1].isRef
              ? document[property[0]][property[1].isRef[0]]
              : document[property[0]]
          }}
        </td>
        <td>
          <div class="documents-table-buttons">
            <div class="button button-edit" (click)="togglePopup(true, i)">
              {{
                isPopupEdit && isPopupVisible && popupIndex == i
                  ? "Close"
                  : "Edit"
              }}
            </div>
            <div
              class="button button-delete"
              (click)="deleteField(document._id)"
            >
              Delete
            </div>
          </div>
        </td>
      </tr>
    </tbody>
  </table>
</main>
